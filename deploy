#!/bin/bash
# Simple deployment wrapper
# Usage: ./deploy backendserver main
#        ./deploy geoserver staging
#        ./deploy llmserver main
#        ./deploy salomeserver develop

SERVICE=$1
BRANCH=${2:-main}

if [ -z "$SERVICE" ]; then
    echo "Usage: ./deploy <service> [branch]"
    echo ""
    echo "Services:"
    echo "  - backendserver"
    echo "  - geoserver"
    echo "  - llmserver"
    echo "  - salomeserver"
    echo ""
    echo "Example: ./deploy backendserver main"
    exit 1
fi

# Determine target server
if [ "$SERVICE" = "salomeserver" ]; then
    TARGET="salome"
else
    TARGET="backend"
fi

echo "ðŸš€ Deploying $SERVICE from branch $BRANCH..."
ansible-playbook -i inventories/prod/hosts.ini playbooks/deploy.yml \
    -e service=$SERVICE \
    -e branch=$BRANCH \
    -e target=$TARGET
